(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-11c1e305"],{"275e":function(e,t,o){},af4d:function(e,t,o){"use strict";o.r(t);o("b0c0"),o("fb6a");var i=o("600d"),s=(o("c2ec"),o("c1df"),o("f7e6")),a=o.n(s),n=o("fded"),l=o("cf45"),c=(o("f2d9"),o("0340")),r=o("f64d"),h={name:"diyDataHistory",i18n:o("89fe"),components:{DeviceHistoryDataModel:n.a},data:function(){return{isMaskShow:!1,selectRow:0,selectCol:0,exportName:"",messageShowLoad:!1,advanced:!0,sheetOptions:{}}},authorize:{},mounted:function(){},activated:function(){var e=this,t=this;this.sheetOptions={container:"luckysheetContent",title:"luckysheetContent",lang:"zh",gridKey:t.$route.params.uuid,plugins:["chart"],loading:{image:function(){return'<svg viewBox="25 25 50 50" class="circular">\n            <circle cx="50" cy="50" r="20" fill="none"></circle>\n            </svg>'},imageClass:"loadingAnimation"},showinfobar:!1,cellRightClickConfig:{customs:[{title:this.$t("diyReport.SelectData"),onClick:function(e,o,i){t.InsertData(e,o,i)}},{title:this.$t("diyReport.SelectDataMax"),onClick:function(e,o,i){t.InsertVar(e,o,i,4)}},{title:this.$t("diyReport.SelectDataMin"),onClick:function(e,o,i){t.InsertVar(e,o,i,5)}},{title:this.$t("diyReport.SelectDataDifference"),onClick:function(e,o,i){t.InsertVar(e,o,i,6)}},{title:this.$t("diyReport.SelectDataSum"),onClick:function(e,o,i){t.InsertVar(e,o,i,7)}},{title:this.$t("diyReport.SelectDataCount"),onClick:function(e,o,i){t.InsertVar(e,o,i,8)}},{title:this.$t("diyReport.SelectDataAverage"),onClick:function(e,o,i){t.InsertVar(e,o,i,9)}},{title:this.$t("diyReport.SelectDate"),onClick:function(e,o,i){t.InsertVar(e,o,i,1)}},{title:this.$t("diyReport.SelectDevice"),onClick:function(e,o,i){t.InsertVar(e,o,i,2)}},{title:this.$t("diyReport.SelectRange"),onClick:function(e,o,i){t.InsertVar(e,o,i,3)}}],copy:!0,copyAs:!1,paste:!0,insertRow:!1,insertColumn:!1,deleteRow:!1,deleteColumn:!1,deleteCell:!1,hideRow:!1,hideColumn:!1,rowHeight:!1,columnWidth:!1,clear:!1,matrix:!1,sort:!1,filter:!1,chart:!1,image:!0,link:!1,data:!1,cellFormat:!1},showtoolbarConfig:{undoRedo:!0,paintFormat:!0,currencyFormat:!1,percentageFormat:!1,numberDecrease:!1,numberIncrease:!1,moreFormats:!1,font:!0,fontSize:!0,bold:!0,italic:!0,strikethrough:!0,underline:!0,textColor:!0,fillColor:!0,border:!0,mergeCell:!0,horizontalAlignMode:!0,verticalAlignMode:!0,textWrapMode:!0,textRotateMode:!0,image:!0,link:!0,chart:!1,postil:!1,pivotTable:!1,function:!1,frozenMode:!1,sortAndFilter:!0,conditionalFormat:!0,dataVerification:!1,splitColumn:!0,screenshot:!1,findAndReplace:!0,protection:!1,print:!1,selectData:!0}},"CN"==this.$i18n.locale?(this.sheetOptions.lang="zh",this.json_fields=this.json_fields_cn):(this.sheetOptions.lang="en",this.json_fields=this.json_fields_en),this.exportName=this.$t("reporting.DataHistory.exportName")+"."+Object(l.a)(new Date,"yyyy-MM-dd hh:mm:ss")+".xlsx",this.$nextTick((function(){var t=new Date,o="/static/reportTemplete/"+e.$route.params.uuid+".xlsx?"+t.getMilliseconds(),i=e.$route.params.uuid,s=e;a.a.transformExcelToLuckyByUrl(o,i,(function(e,t){null!=e.sheets&&0!=e.sheets.length&&(s.sheetOptions.data={},s.sheetOptions.data=e.sheets,s.sheetOptions.title=e.info.name,s.sheetOptions.userInfo=e.info.name.creator,luckysheet.create(s.sheetOptions))}))}))},filters:{formatDate:function(e){var t=new Date(e);return Object(l.a)(t,"yyyy-MM-dd hh:mm:ss")}},created:function(){},watch:{$route:function(){luckysheet.destroy()}},methods:{onSelectData:function(e){luckysheet.setCellValue(this.selectRow,this.selectCol,"{{DataModel."+e.name+"}}")},InsertVar:function(e,t,o,i){this.selectRow=o.rowIndex,this.selectCol=o.columnIndex;var s=luckysheet.getCellValue(this.selectRow,this.selectCol);if(""!=s&&null!=s)s=s.slice(0,s.length-2);else if(1!=i&&2!=i&&3!=i)return;1==i?luckysheet.setCellValue(this.selectRow,this.selectCol,"{{DataModel.HistoryRecordDateTime}}"):2==i?luckysheet.setCellValue(this.selectRow,this.selectCol,"{{DeviceName}}"):3==i?luckysheet.setCellValue(this.selectRow,this.selectCol,"{{TimeRange}}"):4==i?luckysheet.setCellValue(this.selectRow,this.selectCol,s+"的时间段最大值}}"):5==i?luckysheet.setCellValue(this.selectRow,this.selectCol,s+"的时间段最小值}}"):6==i?luckysheet.setCellValue(this.selectRow,this.selectCol,s+"的时间段差值}}"):7==i?luckysheet.setCellValue(this.selectRow,this.selectCol,s+"的时间段和}}"):8==i?luckysheet.setCellValue(this.selectRow,this.selectCol,s+"的时间段数量}}"):9==i&&luckysheet.setCellValue(this.selectRow,this.selectCol,s+"的时间段平均值}}")},InsertData:function(e,t,o){this.$refs.deviceHistoryDataModel.showDataModal(),this.selectRow=o.rowIndex,this.selectCol=o.columnIndex},startDownload:function(){this.isLoadExecl=!0,this.loadExecl=this.$message.loading(this.$t("reporting.DataHistory.LoadingExecl"),0)},finishDownload:function(){this.$message.destroy(this.loadExecl),this.isLoadExecl=!1},filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},GetDeviceModelDataList:function(){var e=this;this.AlarmDataTree=[];Object(i.a)({getType:2}).then((function(t){0==t.data.code&&(e.AlarmDataTree=t.data.list)}))},onDateChange:function(e,t){this.SelectDateRange=t},LoadReportTemplete:function(){var e=new Date,t="/static/reportTemplete/"+this.$route.params.uuid+".xlsx?"+e.getMilliseconds(),o=this;luckysheet.destroy(),a.a.transformExcelToLuckyByUrl(t,"1111",(function(e,t){null!=e.sheets&&0!=e.sheets.length&&(o.sheetOptions.data=e.sheets,o.sheetOptions.title=e.info.name,o.sheetOptions.userInfo=e.info.name.creator,luckysheet.create(o.sheetOptions))}))},back:function(){this.$router.push("/Reporting/DiyReportTemplete")},SaveReportTemplete:function(){var e=this;Object(c.b)(luckysheet.getluckysheetfile(),(function(t){e.dataSource=[];var o={Uuid:e.$route.params.uuid,sheetData:t};e.messageShowLoad=!0,Object(r.f)(o).then((function(t){0==t.data.code&&e.$message.success(e.$t("diyReportTemplete.SaveSuccess"),3),e.messageShowLoad=!1})).catch((function(){e.messageShowLoad=!1,e.$message.destroy(),e.$message.error(e.$t("loginPage.serverError"),3)}))}))}},destroyed:function(){luckysheet.destroy()}},d=(o("afba"),o("2877")),u=Object(d.a)(h,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("a-card",[o("a-row",[o("a-col",{attrs:{span:8}},[o("a-button",{staticStyle:{"margin-left":"10px","margin-top":"10px","margin-bottom":"10px"},attrs:{icon:"save",type:"primary"},on:{click:e.SaveReportTemplete}},[e._v(e._s(e.$t("diyReportTemplete.Save")))]),o("a-button",{staticStyle:{"margin-left":"10px","margin-top":"10px","margin-bottom":"10px"},attrs:{icon:"reload",type:"default"},on:{click:e.LoadReportTemplete}},[e._v(e._s(e.$t("diyReportTemplete.Reload")))]),o("a-button",{staticStyle:{"margin-left":"10px","margin-top":"10px","margin-bottom":"10px"},attrs:{icon:"backward",type:"default"},on:{click:e.back}},[e._v(e._s(e.$t("dataModel.modbusModel.Back")))])],1),o("a-col",{attrs:{span:12}},[o("div",{staticStyle:{"margin-left":"10px","margin-top":"10px","margin-bottom":"10px","margin-right":"10px"}},[o("a-alert",{attrs:{message:e.$t("diyReportTemplete.TempleteTips"),type:"info","show-icon":""}})],1)])],1),o("div",{staticClass:"hello"},[o("div",{staticStyle:{margin:"0px",padding:"0px",height:"600px",top:"5px","z-index":"-1"},attrs:{id:"luckysheetContent"}}),o("div",{directives:[{name:"show",rawName:"v-show",value:e.isMaskShow,expression:"isMaskShow"}],staticStyle:{position:"absolute","z-index":"1000000",left:"0px",top:"0px",bottom:"0px",right:"0px",background:"rgba(255, 255, 255, 0.8)","text-align":"center","font-size":"40px","align-items":"center","justify-content":"center",display:"flex"}},[e._v("Downloading")]),o("device-history-data-model",{ref:"deviceHistoryDataModel",on:{onSelectDataModel:e.onSelectData}})],1)],1)}),[],!1,null,"370032d2",null);t.default=u.exports},afba:function(e,t,o){"use strict";o("275e")}}]);