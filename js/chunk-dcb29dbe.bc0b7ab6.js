(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-dcb29dbe"],{"2c18":function(t,e,i){},"33e8":function(t,e,i){"use strict";i.r(e);i("ac1f"),i("1276"),i("b0c0"),i("d3b7"),i("25f0");var r=i("6260"),a=(i("c1df"),i("1d40")),n=i("cf45"),c=i("d21d"),s={name:"TaskPlan",i18n:i("89fe"),data:function(){return{pagination:{pageSize:15,showSizeChanger:!0},ScriptType:0,isCharge:!0,CodeContent:"",isEdit:!1,messageShowLoad:!1,advanced:!0,refIconLoading:!1,columns:[{width:"10%",slotName:"ISMScripts.ScriptName",scopedSlots:{customRender:"ScriptName",title:"ISMScripts.ScriptName"},dataIndex:"ScriptName"},{slotName:"ISMScripts.ScriptType",width:"10%",scopedSlots:{customRender:"ScriptType",title:"ISMScripts.ScriptType"},dataIndex:"ScriptType"},{slotName:"ISMScripts.ScriptDes",width:"30%",scopedSlots:{customRender:"Description",title:"ISMScripts.ScriptDes"},dataIndex:"Description"},{width:"15%",slotName:"dataModel.modelTableOpt",scopedSlots:{customRender:"action",title:"dataModel.modelTableOpt"}}],dataSource:[],addVisible:!1,error:"",editUuid:"",editVisible:!1,PlanForm:this.$form.createForm(this),editForm:this.$form.createForm(this),textAreValue:"",that:this,value:1}},components:{codeEditor:r.a},authorize:{},filters:{formatDate:function(t){var e=new Date(t);return Object(n.a)(e,"yyyy-MM-dd hh:mm:ss")},TaskPlanFilters:function(t,e){for(var i=t,r="",a=(i=i.split(" "))[5].split(","),n=0;n<a.length;n++)for(var c=0;c<e.TaskExecPlanList.length;c++)parseInt(a[n])==e.TaskExecPlanList[c].value&&(r=r+e.$t(e.TaskExecPlanList[c].name)+",");return r=r+i[2]+":"+i[1]+":"+i[0]}},mounted:function(){},activated:function(){},created:function(){this.GetScriptList()},watch:{$route:function(){this.dataSource=[],this.GetScriptList()}},methods:{chargeScriptType:function(t){this.ScriptType=t},changeTextarea:function(t){this.CodeContent=t},onClose:function(){this.addVisible=!1},doSysScript:function(t){var e=[],i=this;e.push(t);var r={Script:e};Object(a.c)(r).then((function(t){i.settingLoading=!1,0==t.data.code?(i.$message.success(i.$t(t.data.msg)),i.settingVisible=!1):i.$message.error(i.$t(t.data.msg))})).catch((function(t){i.settingLoading=!1,i.$message.error(i.$t("readData.SetFailed"))})).finally((function(t){i.settingLoading=!1}))},DoDisableSysScript:function(t,e){var i=this,r={uuid:t,disable:void 0===(e=e?0:1)?1:e};Object(a.b)(r).then((function(t){i.settingLoading=!1,200==t.data.code?(i.$message.success("成功"),i.settingVisible=!1,i.GetScriptList()):i.$message.error(i.$t(t.data.msg))})).catch((function(t){i.settingLoading=!1,i.$message.error(i.$t("readData.SetFailed"))})).finally((function(t){i.settingLoading=!1}))},GetScriptList:function(){var t=this;this.dataSource=[],Object(c.e)().then((function(e){t.refIconLoading=!1,200==e.data.code?(t.dataSource=e.data.list,t.addVisible=!1):2001==e.data.code?t.$message.error(t.$t("displayModel.ModelExist"),3):2003==e.data.code&&t.$message.error(t.$t("displayModel.AddModelFailed"),3)}))},AddScript:function(){var t=this;this.PlanForm.validateFields((function(e){if(!e){var i={ScriptName:t.PlanForm.getFieldValue("ScriptName"),Delay:parseInt(t.PlanForm.getFieldValue("ScriptDelay")),ScriptContent:t.CodeContent,ScriptType:parseInt(t.PlanForm.getFieldValue("ScriptType")),Description:t.PlanForm.getFieldValue("ScriptDes")};Object(c.a)(i).then((function(e){2002==e.data.code?(t.GetScriptList(),t.addVisible=!1,t.$message.success(t.$t("ISMScripts.ScriptAddSuccess"),3)):t.$message.error(t.$t("ISMScripts.ScriptAddFailed"),3)}))}}))},EditScript:function(){var t=this;this.PlanForm.validateFields((function(e){if(!e){var i={Uuid:t.EditUUid,data:{ScriptName:t.PlanForm.getFieldValue("ScriptName"),Delay:parseInt(t.PlanForm.getFieldValue("ScriptDelay")),ScriptContent:t.CodeContent,ScriptType:parseInt(t.PlanForm.getFieldValue("ScriptType")),Description:t.PlanForm.getFieldValue("ScriptDes")}};Object(c.d)(i).then((function(e){200==e.data.code?(t.GetScriptList(),t.addVisible=!1,t.$message.success(t.$t("ISMScripts.ScriptEditSuccess"),3)):t.$message.error(t.$t("ISMScripts.ScriptEditFailed"),3)}))}}))},GoToEdit:function(t){var e=this;e.isCharge=!1,this.isEdit=!0,this.ScriptType=t.ScriptType,this.addVisible=!0,e.EditUUid=t.ScriptUuid,e.CodeContent=t.ScriptContent,setTimeout((function(){e.isCharge=!0,e.PlanForm.setFieldsValue({ScriptName:t.ScriptName,ScriptDelay:t.Delay.toString(),ScriptType:t.ScriptType,ScriptDes:t.Description})}),200)},refresh:function(){this.refIconLoading=!0,this.GetScriptList()},ChargeTaskContent:function(t){this.TaskContent=t},deleteRecord:function(t){var e=this,i={ScriptUuid:t};Object(c.c)(i).then((function(t){200==t.data.code?(e.GetScriptList(),e.addVisible=!1,e.$message.success(e.$t("ISMScripts.ScriptDelSuccess"),3)):e.$message.error(e.$t("ISMScripts.ScriptDelFailed"),3)}))},CheckScript:function(){var t=this,e={Script:t.CodeContent};Object(c.b)(e).then((function(e){e.data.code<0?t.$message.error(e.data.msg,3):t.$message.success(t.$t("ISMScripts.ScriptCheckResult")+e.data.msg,3)}))}}},o=(i("6ec1"),i("2877")),l=Object(o.a)(s,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("a-card",[i("a-space",{staticClass:"operator"},[i("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:function(e){t.addVisible=!0,t.isEdit=!1}}},[t._v(t._s(t.$t("dataModel.newModel")))]),i("a-button",{attrs:{type:"default",icon:"sync",loading:t.refIconLoading},on:{click:function(e){return t.refresh()}}},[t._v(t._s(t.$t("dataModel.refModel")))])],1),i("a-spin",{staticStyle:{padding:"1px"},attrs:{spinning:t.messageShowLoad,tip:"Loading..."}},[i("a-table",{attrs:{rowKey:"ScriptName",pagination:t.pagination,columns:t.columns,"data-source":t.dataSource},scopedSlots:t._u([{key:"ScriptType",fn:function(e){return i("div",{},[0==e?i("span",[t._v(t._s(t.$t("ISMScripts.ScriptAuto")))]):1==e?i("span",[t._v(t._s(t.$t("ISMScripts.ScriptHandle")))]):t._e()])}},{key:"action",fn:function(e,r){return i("div",{},[i("a",{staticStyle:{color:"#e89924"},on:{click:function(e){return t.doSysScript(r.ScriptUuid)}}},[i("icon-font",{attrs:{type:"icon-gongjulan-zhihang"}}),t._v(t._s(t.$t("ISMScripts.ExecScript")))],1),t._v(" | "),0==r.IsDisable?i("a",{staticStyle:{color:"#d81e06"},on:{click:function(e){return t.DoDisableSysScript(r.ScriptUuid,r.IsDisable)}}},[i("icon-font",{attrs:{type:"icon-jinzhitishi"}}),i("span",[t._v(t._s(t.$t("ISMScripts.DisableScript")))])],1):t._e(),1==r.IsDisable?i("a",{staticStyle:{color:"#1296db"},on:{click:function(e){return t.DoDisableSysScript(r.ScriptUuid,r.IsDisable)}}},[i("icon-font",{attrs:{type:"icon-cangpeitubiao_qiyong"}}),i("span",[t._v(t._s(t.$t("ISMScripts.EnableScript")))])],1):t._e(),t._v(" | "),i("a",{staticStyle:{color:"#13C2C2"},on:{click:function(e){return t.GoToEdit(r)}}},[i("a-icon",{attrs:{type:"edit"}}),t._v(t._s(t.$t("dataModel.modelDetail")))],1),t._v(" | "),i("a-popconfirm",{attrs:{title:t.$t("dataModel.deleteConfirm")},on:{confirm:function(e){return t.deleteRecord(r.ScriptUuid)}}},[i("a-icon",{staticStyle:{color:"red"},attrs:{slot:"icon",type:"question-circle-o"},slot:"icon"}),i("a-icon",{attrs:{type:"delete",theme:"twoTone","two-tone-color":"#eb2f96"}}),i("a",{staticStyle:{color:"#eb2f96"}},[t._v(t._s(t.$t("dataModel.delete")))])],1)],1)}}])},[t._l(t.columns,(function(e,r){return i("template",{slot:e.slotName},[i("span",{key:r},[t._v(t._s(t.$t(e.slotName)))])])}))],2)],1),i("a-drawer",{attrs:{title:t.isEdit?t.$t("ISMScripts.editScript"):t.$t("ISMScripts.addScript"),width:800,visible:t.addVisible,"body-style":{paddingBottom:"80px"}},on:{close:t.onClose}},[i("a-form",{attrs:{form:t.PlanForm,layout:"vertical"}},[i("a-row",{attrs:{gutter:16}},[i("a-col",{attrs:{span:8}},[i("a-form-item",{attrs:{label:t.$t("ISMScripts.ScriptName")}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["ScriptName",{rules:[{required:!0,message:t.$t("ISMScripts.ScriptName"),whitespace:!0}]}],expression:"['ScriptName', {rules: [{ required: true, message: $t('ISMScripts.ScriptName'), whitespace: true}]}]"}],attrs:{autocomplete:"autocomplete"}})],1)],1),i("a-col",{attrs:{span:8}},[i("a-form-item",{attrs:{label:t.$t("ISMScripts.ScriptType")}},[i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["ScriptType",{initialValue:0,rules:[{type:"number",required:!0,message:t.$t("ISMScripts.ScriptType"),whitespace:!0}]}],expression:"['ScriptType', {initialValue:0,rules: [{ type:'number',required: true, message: $t('ISMScripts.ScriptType'), whitespace: true}]}]"}],attrs:{autocomplete:"autocomplete"},on:{change:t.chargeScriptType}},[i("a-select-option",{key:0,attrs:{value:0}},[t._v(t._s(t.$t("ISMScripts.ScriptAuto")))]),i("a-select-option",{key:1,attrs:{value:1}},[t._v(t._s(t.$t("ISMScripts.ScriptHandle")))])],1)],1)],1),0==t.ScriptType?i("a-col",{attrs:{span:8}},[i("a-form-item",{attrs:{label:t.$t("ISMScripts.ScriptDelay")}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["ScriptDelay",{rules:[{required:!1,message:t.$t("ISMScripts.ScriptDelay"),whitespace:!0}]}],expression:"['ScriptDelay', {rules: [{ required: false, message: $t('ISMScripts.ScriptDelay'), whitespace: true}]}]"}],attrs:{autocomplete:"autocomplete"}})],1)],1):t._e()],1),i("a-row",{attrs:{gutter:16}},[i("a-col",{attrs:{span:24}},[i("a-form-item",{attrs:{label:t.$t("ISMScripts.ScriptContent")}},[t.isCharge?i("code-editor",{attrs:{value:t.CodeContent,language:"javascript"},on:{input:t.changeTextarea}}):t._e()],1)],1)],1),i("a-row",{attrs:{gutter:16}},[i("a-col",{attrs:{span:24}},[i("a-form-item",{attrs:{label:t.$t("ISMScripts.ScriptDes")}},[i("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["ScriptDes",{rules:[{required:!0,message:t.$t("ISMScripts.ScriptDes"),whitespace:!0}]}],expression:"['ScriptDes', {rules: [{ required: true, message: $t('ISMScripts.ScriptDes'), whitespace: true}]}]"}],attrs:{autocomplete:"autocomplete"}})],1)],1)],1)],1),i("div",{style:{position:"absolute",right:0,bottom:0,width:"100%",borderTop:"1px solid #e9e9e9",padding:"10px 16px",background:"#fff",textAlign:"right",zIndex:1}},[i("a-button",{style:{marginRight:"8px"},attrs:{type:"danger"},on:{click:t.CheckScript}},[t._v(t._s(t.$t("ISMScripts.ScriptCheck")))]),t.isEdit?t._e():i("a-button",{style:{marginRight:"8px"},attrs:{type:"primary"},on:{click:function(e){return t.AddScript()}}},[t._v(" "+t._s(t.$t("TaskPlan.TaskAdd"))+" ")]),t.isEdit?i("a-button",{style:{marginRight:"8px"},attrs:{type:"primary"},on:{click:function(e){return t.EditScript()}}},[t._v(" "+t._s(t.$t("TaskPlan.TaskEdit"))+" ")]):t._e(),i("a-button",{on:{click:t.onClose}},[t._v(" "+t._s(t.$t("device.CancelButton"))+" ")])],1)],1)],1)}),[],!1,null,"7cb62a83",null);e.default=l.exports},6260:function(t,e,i){"use strict";i("d3b7"),i("7db0"),i("a7be"),i("8c2e"),i("7393"),i("f9d4"),i("959b"),i("ffda"),i("44d5"),i("db91"),i("02f0"),i("9da3");var r=i("56b3"),a={name:"CommonEditor",props:{value:{type:String,default:""},language:{type:String,default:null}},data:function(){return{CommonEditor:!1,code:"",coder:null,mode:"javascript",theme:"default",modes:[{value:"javascript",label:"Javascript"},{value:"x-java",label:"Java"},{value:"x-python",label:"Python"},{value:"x-sql",label:"SQL"},{value:"x-shell",label:"Shell"},{value:"x-powershell",label:"PowerShell"},{value:"x-php",label:"PHP"}]}},watch:{language:{handler:function(t){var e=this;this.getCoder().then((function(){if(t){var i=e.getLanguage(t);i&&(e.mode=i.label,e.coder.setOption("mode","text/".concat(i.value)))}}))},immediate:!0}},computed:{coderOptions:function(){return{line:!0,mode:"application/json",theme:"blackboard",tabSize:1,lineNumbers:!0,cursorHeight:.8,autoCloseBrackets:!0,autoComplete:!1,matchBrackets:!0,lineWrapping:"wrap",showCursorWhenSelecting:!0,smartIndent:!0,completeSingle:!1}}},mounted:function(){this.initialize()},methods:{initialize:function(){var t=this;this.coder=r.fromTextArea(this.$refs.textarea,this.coderOptions),this.coder.on("inputRead",(function(){t.coder.showHint()})),this.value||this.code?this.setCodeContent(this.value||this.code):this.coder.setValue(""),this.coder.on("change",(function(e){t.code=e.getValue(),t.$emit&&t.$emit("input",t.code)}))},setCodeContent:function(t){var e=this;setTimeout((function(){t?e.coder.setValue(t):e.coder.setValue("")}),300)},getCoder:function(){var t=this;return new Promise((function(e){!function i(){t.coder?e(t.coder):setTimeout(i,10)}()}))},getLanguage:function(t){return this.modes.find((function(e){var i=t.toLowerCase(),r=e.label.toLowerCase(),a=e.value.toLowerCase();return r===i||a===i}))},changeMode:function(t){this.coder.setOption("mode","text/".concat(t));var e=this.getLanguage(t).label.toLowerCase();this.$emit("language-change",e)}}},n=(i("edc2"),i("2877")),c=Object(n.a)(a,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{className:"common-editor"}},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],ref:"textarea",domProps:{value:t.value},on:{input:function(e){e.target.composing||(t.value=e.target.value)}}})])}),[],!1,null,null,null);e.a=c.exports},"6ec1":function(t,e,i){"use strict";i("2c18")},"6f4d":function(t,e,i){},d21d:function(t,e,i){"use strict";i.d(e,"a",(function(){return c})),i.d(e,"c",(function(){return o})),i.d(e,"d",(function(){return u})),i.d(e,"e",(function(){return d})),i.d(e,"b",(function(){return m}));var r=i("c964"),a=(i("96cf"),i("7424")),n=i("b775");function c(t){return s.apply(this,arguments)}function s(){return(s=Object(r.a)(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(n.g)(a.ADDSCRIPT,n.b.POST,e));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function o(t){return l.apply(this,arguments)}function l(){return(l=Object(r.a)(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(n.g)(a.DELSCRIPT,n.b.POST,e));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function u(t){return p.apply(this,arguments)}function p(){return(p=Object(r.a)(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(n.g)(a.EDITSCRIPT,n.b.POST,e));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function d(){return S.apply(this,arguments)}function S(){return(S=Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(n.g)(a.SCRIPTLIST,n.b.POST));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function m(t){return f.apply(this,arguments)}function f(){return(f=Object(r.a)(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(n.g)(a.CHECKSCRIPT,n.b.POST,e));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}},edc2:function(t,e,i){"use strict";i("6f4d")}}]);